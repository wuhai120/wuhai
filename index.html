<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width,height=device-height,inital-scale=1.0,maximum-scale=1.0,user-scalable=no;" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="format-detection" content="telephone=no" />
    <title>ESCH首页</title>
    <script src="js/jquery.js" type="text/javascript"></script>
    <link href="Css/mobilemain.css" rel="stylesheet" />
    <script src="JS/jquery.js"></script>
    <script src="JS/web3.min.js"></script>
    <script src="JS/public.js"></script>
</head>
<body style="background-color: #5777ce;">
    <form id="form1" runat="server">
         
    <div class="wrap">
        <div class="main">
            <div class="ES_logo">
                <span ><a href="/en/index.html">
                    <img src="images/en.png" /></a></span><img src="images/logo.png" />&nbsp; <i>合约联盟</i>
                <div class="clear"></div>
            </div>
            <div><a href="#">
                <img src="images/banner.jpg" width="100%" /></a></div>
            <div class="jmtopnews">
                <div id="tgBigox">
                    <div id="tgGoox">
                                                参与规则
ESCH28天合約
参与规则
参与金额2-20个ETH，月收益15.12%---21.6%，满仓挂单收益21.6%  
满7天后可卖出合约本金的10%，ETH秒到自己的冷钱包；  
满14天后可卖出合约本金的20%，ETH秒到自己的冷钱包；  
满21天后可卖出合约本金的65%，ETH秒到自己的冷钱包；  
满28天卖出合约剩余本金的5％及静态利息15.12％，总计20.12%，同时买入等于、大于上一次合约进入下一个周期，卖出合约的20.12%秒到自己的冷钱包。  

备注：  
每个钱包24小时限制参与一个合约，满24小時收益0.72%，21天收益截止。 

进场、出场均自动扣除1% ESCH token代币作为手续费（例如投资10个ETH收取100个ESCH）。从合约购买ESCH ，1个ETH兑换1000 个ESCH ，起步0.1个ETH兑换。购买ESCH的ETH进入合约钱包。开启合约手续费根据ESCH的价值核算。

当合约池总量从高到低递减的时候，总量到50000个ETH发放部分等价值的ESCH。

用户数据的增长及平台会推出不同收益及类型的理财产品供用户选择多元化理财。
                    </div>
                </div>
            </div>
            <script type="text/javascript">
                var cars = $("#tgGoox").width();
                var i = 0;
                function start() {
                    i--;
                    if (i <= -cars) {
                        i = 1 * cars;
                        document.getElementById('tgGoox').style.right = -cars + 'px';
                    } else {
                        document.getElementById('tgGoox').style.left = i + 'px';
                    }
                    setTimeout(start, 50);
                }
                onload = function () { setTimeout(start, 100) };
            </script>
            <div class="ES_titlebox">
                <div class="deption_title"><a href="/HeYueRule.html"><span>more&nbsp;<img src="images/jt_pic.png" height="15px" /></span>规则说明</a></div>
                <div class="deption_title1">
                    <div class="title1">
                        "智能合约”的概念早于区块链时代，概念首次出现于1996年：一套以数字形式定义的约定，
                       包括合约参与方可以在上面执行这些约定的协议。
                    </div>
                    <div>
                        <div class="contract_left"style="width:100%;text-align:center;"><a href="AddressMigration.html" style="background:#c30101;">地址迁移</a></div>
                        <div class="contract_left"style="width:100%;text-align:center;"><a href="HYstatus.html" style="background:#c30101;">原合约迁移</a></div>
                        <div class="contract_left"><a href="javascript:HeYueAdd();">参与合约</a></div>
                        <div class="contract_right"><a href="/HeYueRule.html">合约规则</a></div>
                        <div class="clear"></div>
                    </div>
                </div>
                <div class="deption_title2">
                    <ul>
                        <li>
                            <a href="NewHYstatus.html">
                                <div class="pic">
                                    <img src="/images/index_pic1.png" height="90px" /></div>
                                <div class="title">当前合约状态</div>
                            </a>
                        </li>
                        <li>
                            <a href="Contract_sy.html">
                                <div class="pic">
                                    <img src="/images/index_pic2.png" height="90px" /></div>
                                <div class="title">合约收益</div>
                            </a>
                        </li>
                        <li>
                            <a href="/Nodereward.html">
                                <div class="pic">
                                    <img src="/images/index_pic3.png" height="90px" /></div>
                                <div class="title">节点奖励</div>
                            </a>
                        </li>
                    </ul>
                    <div class="clear"></div>
                </div>
            </div>
        </div>
    </div>
        <input type="hidden" id="hfaddress" />
        <input type="hidden" id="hfqsadd" />
   
        <input type="hidden" id="xy3order" />
    <script type="text/javascript">
        function HeYueAdd() {
            var add = $("#hfaddress").val();
            $.ajax({
                url: adminurl+"/ajax/ajax.ashx?action=HeYueAdd&address=" + add,
                type: "get",
                success: function (msg) {
                    if (msg == "NO") {
                        location.href = "XuDanHeYue.html";
                    } else {
                        location.href = "HeYueAdd.html";
                    }
                }
            })
        }

        $(document).ready(function () {
            //var lang = getCookie("EschLanguage");

            //if (lang == "en") {
            //    location.href = "/En/index.html";
            //} else {
            //    setCookie("EschLanguage", "ch");
            //}
            $(".pnav").each(function (i) {
                var nowImg = "/images/icon_" + i + ".png";
                var CurrImg = "/images/icon_" + i + "_" + i + ".png";
                $(this).click(function () {
                    $(".subnav").hide();
                    $(".pnavImg").each(function (j) {
                        $(this).attr("src", "/images/icon_" + j + ".png");
                    });

                    if ($(this).attr("class").indexOf("pnavCurr") < 0) {
                        $(".pnav").removeClass("pnavCurr");
                        $(this).addClass("pnavCurr");
                        $(this).find("img.pnavImg").attr("src", CurrImg);
                        $(".subnav").eq(i).slideDown({ duration: 200, easing: 'linear' });
                    }
                    else {
                        $(this).removeClass("pnavCurr");
                        $(this).find("img.pnavImg").attr("src", nowImg);
                        $(".subnav").eq(i).hide();
                    }
                });
                var ahref = $(this).find("a").attr("href").toLowerCase();

                if (ahref.indexOf('?') > 0)
                    ahref = ahref.substring(0, ahref.indexOf('?'));
                if (window.location.pathname.toLowerCase() == ahref) {
                    $(this).addClass("pnavCurr");
                    $(this).find("img.pnavImg").attr("src", CurrImg);
                }
            });
            var locat = window.location.pathname.toLowerCase();

        });
        var abi = [{
            "constant": true,
            "inputs": [
                {
                    "name": "_ad3",
                    "type": "address"
                }
            ],
            "name": "cE",
            "outputs": [
                {
                    "name": "_MsAdToN",
                    "type": "uint32"
                },
                {
                    "name": "_MsFa",
                    "type": "address"
                },
                {
                    "name": "_MsBo",
                    "type": "uint32"
                },
                {
                    "name": "_MsSon",
                    "type": "uint32"
                }
            ],
            "payable": false,
            "stateMutability": "view",
            "type": "function"
        }, {
            "constant": true,
            "inputs": [
                {
                    "name": "_ywbh",
                    "type": "uint32"
                },
                {
                    "name": "_ad",
                    "type": "address"
                }
            ],
            "name": "cBun",
            "outputs": [
                {
                    "name": "_ywbh3",
                    "type": "uint256"
                },
                {
                    "name": "_time",
                    "type": "uint256"
                },
                {
                    "name": "_now",
                    "type": "uint256"
                },
                {
                    "name": "sjc",
                    "type": "uint256"
                },
                {
                    "name": "_ywzt",
                    "type": "uint8"
                },
                {
                    "name": "_BuTotal",
                    "type": "uint32"
                },
                {
                    "name": "_bizNum",
                    "type": "uint256"
                }
            ],
            "payable": false,
            "stateMutability": "view",
            "type": "function"
        }]
        //var address = "0x34848f3c3934733d3ebc6f82489346592566c777";2020-5-9
        var address = "0x5f43578ec5a2aeb661b15bb2fb9d71154bae84f2";
        var myContract = web3.eth.contract(abi).at(address);
        window.addEventListener('load', function () {
            if (typeof web3 !== 'undefined') {
                web3 = new Web3(web3.currentProvider);
                if (web3.currentProvider.isMetaMask == true) {
                    $("#env").html("网页MetaMask使用中...");
                } else {
                    $("#env").html("未使用网页MetaMask... ");
                }
            } else {
                $("#env").html("未提供WEB3通道，请检查您的设置...");
            }
            web3.eth.getAccounts(function (err, accounts) {
                if (accounts.length == 0) {
                    $("#account").html("请解锁！");
                } else {
                    $("#account").html(accounts);
                    if (accounts != $("#hfaddress").val()) {
                        $("#hfaddress").val(accounts[0]);

                    }
                    var address = accounts[0];
                    $.ajax({
                        type: "get",
                        url: adminurl+"/ajax/ajax.ashx?action=Get3OrderNew&address=" + address,
                        success: function (msg) {
                            $("#xy3order").val(msg);
                            getstatus(0);
                        }
                    })
                    //if ($("#hfqsadd").val() != "") {
                    //    setcookie("UserAddressESCH", $("#hfqsadd").val());
                    //} else {
                    login(accounts[0]);
                    //}

                    myContract.cE(accounts[0], function (err, res) {
                        if (!err) {

                            var ZTAccount = res[1];
                            var number = parseInt(res[0]);
                            var MsBo = parseInt(res[2]);
                            var childcount = parseInt(res[3]);

                            updateuser($("#hfaddress").val(), ZTAccount, number, MsBo, childcount);

                        }
                    })
                }
            });
        })
        function getstatus(obj) {
            //var ids = $("#hfids").val().split(',');
            //if (ids.length > obj) {
            //    var idd = parseInt(ids[obj]).split('_')
            //    if (idd.length == 2) {
            //        var id =parseInt( idd[0]);
            //        var status = idd[1];
            //        myContract.cBun(id, function (err, res) {
            //            console.log(id);
            //            if (!err) {
            //                var newstatus = res[4] + "";
            //                if (newstatus != status) {
            //                    $.ajax({
            //                        type: "post",
            //                        url: "/ajax/ajax.ashx?action=updatestatus",
            //                        data: {
            //                            id: id,
            //                            status: newstatus
            //                        },
            //                        success: function (da) {
            //                            getstatus(obj+1);
            //                        }
            //                    })
            //                } else {
            //                    getstatus(obj+1);
            //                }
            //            }
            //        })
            //    }
            //}
            var ids = $("#xy3order").val().split(',');
            var address = $("#hfaddress").val();
            myContract.cBun(parseInt(ids[obj]), address, function (err, res) {
                console.log(parseInt(ids[obj]));
                if (!err) {
                    if (res[0] != 0) {
                        var ywbh = res[0] + "";
                        var ywzt = res[4] + "";
                        $.ajax({
                            type: "post",
                            url: adminurl+"/ajax/ajax.ashx?action=updatestatus",
                            data: {
                                address: function () { return $("#account").val(); },
                                ywbh: ywbh,
                                ywzt: ywzt
                            },
                            success: function (da) {
                                if (da == "adderr") {
                                    //alert("Login address error");
                                } else {
                                    getstatus(obj + 1);
                                }
                            }
                        })
                    }
                }
            })


        }
    </script>
    <div class="navbox">
        <div class="navli">
            <div class="pnav">
                <a class="nava" href="/index.html">
                    <img class="pnavImg" src="/images/icon_0.png" height="30px" />
                    <p class="txt">首页</p>
                </a>
            </div>
            <div class="subnav">
            </div>
        </div>
        <div class="navli">
            <div class="pnav">
                <a class="nava" href="/BuyEsch.html">
                    <img class="pnavImg" src="/images/icon_1.png" height="30px" />
                    <p class="txt">购买ESCH</p>
                </a>
            </div>
            <div class="subnav">
            </div>
            </div>
    
        </div>
       
    <script src="JS/FT_zh.js"></script>
   
    </form>
</body>
</html>
